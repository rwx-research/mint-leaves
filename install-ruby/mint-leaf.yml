name: mint/install-ruby
version: 1.0.5
description: Install Ruby, a dynamic programming language with a focus on simplicity and productivity

parameters:
  ruby-version:
    description: 'Version of Ruby to install'
    required: false
  ruby-version-file:
    description: 'File containing version of Ruby to install, commonly .ruby-version'
    required: false

tasks:
  - key: install
    run: |
      if [[ -n "$RUBY_VERSION_FILE" ]]; then
        RUBY_VERSION=$(cat "$RUBY_VERSION_FILE")
      fi

      curl -O https://rvm.io/binaries/ubuntu/22.04/x86_64/ruby-$RUBY_VERSION.tar.bz2
      tar jxvf ruby-$RUBY_VERSION.tar.bz2

      sudo cp -r ruby-$RUBY_VERSION/bin/* /usr/local/bin/
      sudo cp -r ruby-$RUBY_VERSION/include/* /usr/local/include/
      sudo cp -r ruby-$RUBY_VERSION/lib/* /usr/local/lib/
      sudo cp -r ruby-$RUBY_VERSION/share/* /usr/local/share/

      rm ruby-$RUBY_VERSION.tar.bz2

      ruby -v
      bundle -v
    env:
      RUBY_VERSION: ${{ params.ruby-version }}
      RUBY_VERSION_FILE: ${{ params.ruby-version-file }}
