name: rwx/install-abq
version: 1.0.1
description: ABQ is a universal test runner that runs test suites in parallel. Itâ€™s the best tool for splitting test suites into parallel jobs in CI.

parameters:
  rwx-access-token:
    description: 'RWX_ACCESS_TOKEN used to authenticate into ABQ'
    required: true

tasks:
  - key: install
    run: |
      tmp="$(mktemp -d)/abq"
      curl -o $tmp -fsSL \
        -H "Authorization: Bearer $RWX_ACCESS_TOKEN" \
        "https://cloud.rwx.com/abq/api/releases/v1/Linux/x86_64/abq?install_id=${{ mint.run.id }}"
      sudo install $tmp /usr/local/bin
      rm $tmp
      abq --version
    env:
      RWX_ACCESS_TOKEN: ${{ params.rwx-access-token }}
